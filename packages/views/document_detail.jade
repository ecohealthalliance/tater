template(name="documentDetail")
  if document
    .document-detail-container
      +documentDetailCodingKeywords
      .document-heading.pane-head.pane-head-m
        h1.document-title= document.title
        a.help-link.help-link-document.pull-right(href="{{path route='/help?topic=annotating-documents'}}")
          i.fa.fa-question-circle

        if accessCode
          button.finished-annotating.btn.btn-primary(data-toggle="modal" data-target="#completionCodeModal")
            i.fa.fa-check-circle.icon-left
            span Finished Annotating
      .document-container.pane.pane-middle
        #documentContainer
          #documentBody.document-body
            .document-wrapper
              pre.document-text= document.body
              if Template.subscriptionsReady
                each annotationLayers
                  .document-annotations
                    pre.document-text= this
      .annotation-search-container.pane-head.pane-head-r
        if Template.subscriptionsReady
          input#annotation-search-field.annotation-search.form-control(type="text" placeholder="Search Annotations")
          if searching
            i.fa.fa-times-circle.clear-search
      .annotation-container.pane.pane-r
        ul.annotations.list-unstyled
          if Template.subscriptionsReady
            each annotations
              li(data-annotation-id=_id class="annotation-color-#{color} {{selected}}")
                if accessCode
                  span.code
                    span.header= header
                else
                  span.code= code
                  if flagged
                    span.toggle-flag.flagged.fa.fa-flag(data-annotation-id=_id)
                  else
                    span.toggle-flag.fa.fa-flag-o(data-annotation-id=_id)
                span.user= annotationUserEmail
                .delete-annotation.btn-delete(data-annotation-id=_id)
                  i.fa.fa-trash
            else
              if searching
                .no-results
                  i.fa.fa-search
                  p Sorry, no annotations found.
              else
                .no-results
                  p No annotations currently present.
          else
            .loading

  #completionCodeModal.modal.fade
    .modal-dialog
      .modal-content
        .modal-body
          p.instructions Thanks for completing this HIT.  Please enter this code into Mechanical Turk.
          h5.completion-code Code:
            span {{accessCode}}
